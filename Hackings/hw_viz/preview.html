<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Interactive Latencies You Should Know</title>
    <script src="http://codemirror.net/lib/codemirror.js"></script>
    <script src=http://codemirror.net/mode/xml/xml.js></script>
    <script src=http://codemirror.net/mode/javascript/javascript.js></script>
    <script src=http://codemirror.net/mode/css/css.js></script>
    <script src=http://codemirror.net/mode/htmlmixed/htmlmixed.js></script>
    <link rel=stylesheet href=http://codemirror.net/lib/codemirror.css>
    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
        padding-left: 10px;
        padding-right: 10px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
    </style>
    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet">
    <style type=text/css>
      .CodeMirror {
        width: 99%;
        border: 1px solid black;
      }
      iframe {
        width: 99%;
        height: 400px;
      }
    </style>
  </head>
  <body>
    <iframe id=preview></iframe>
    <textarea id=code name=code>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script>
    function getPayloadBytes() {
        // 1 MB
        return Math.pow(10, 6);
    }
    function getCycle() {
        return 0.5; // ns
    }
    function getL2Latency() {
        return 7; // ns
    }
    function getMemLatency() {
        return 100; // ns
    }
    function getNICTransmissionDelay(payloadBytes) {
        // 1Gb/s = 10^9 b/s = 1b/ns
        // Bytes -> bits
        return payloadBytes * 8;
    }
    function getBusTransmissionDelay(payloadBytes) {
        // 1MB / 250,000 ns = 10^6B / 250,000 ns = 4B/ns
        return payloadBytes / 4;
    }
    function getSSDLatency() {
        return 150000; // ns
    }
    function getSSDTransmissionDelay(payloadBytes) {
        // 1MB / 1,000,000 ns = 1B/ns
        return payloadBytes;
    }
    function getSeek() {
        // Not changing by much
        return 10000000; // ns
    }
    function getDiskTransmissionDelay(payloadBytes) {
        // 1MB / 20,000,000ns = 1/20 B / ns
        return payloadBytes / (1.0/20); // ns
    }
    function getDCRTT() {
        // Not changing by much
        return 500000; // ns
    }
    function getWanRTT() {
        // Not changing by much
        return 150000000; // ns
    }
    function ns() {
        return "1 ns";
    }
    function L1() {
        var ns = getCycle();
        return "L1 cache reference: " + ns + "ns";
    }
    function branch() {
        var ns = 10*getCycle();
        return "Branch mispredict: " + ns + "ns";
    }
    function L2() {
        var ns = getL2Latency();
        return "L2 cache reference: " + ns + "ns";
    }
    function mutex() {
        var ns = 50*getCycle();
        return "Mutex lock/unlock: " + ns + "ns";
    }
    function ns100() {
        return "= 100ns";
    }
    function mem() {
        var ns = getMemLatency();
        return "Main memory reference: " + ns + "ns";
    }
    function micro() {
        return "= 1 &mu;s";
    }
    function zippy() {
        var ns = 6000 * getCycle();
        var us = ns / 1000;
        return "Compress 1KB wth Zippy: " + ns + "ns = " + us + "&mu;s";
    }
    function tenMicro() {
        return "= 10 &mu;s";
    }
    function network() {
        var ns = getNICTransmissionDelay(2000);
        var us = ns / 1000;
        return "Send 2KB over 1Gbps network: " + ns + "ns = " + us + "&mu;s";
    }
    function ssdRandom() {
        var ns = getSSDLatency();
        var us = ns / 1000;
        return "SSD random read: " + ns + "ns = " + us + "&mu;s";
    }
    function mbMem() {
        var ns = getBusTransmissionDelay(getPayloadBytes());
        var us = ns / 1000;
        return "Read 1MB sequentially from memory: " + ns + "ns = " + us + "&mu;s";
    }
    function rtt() {
        var ns = getDCRTT();
        var ms = ns / 1000000;
        return "Round trip in same datacenter: " + ns + "ns = " + ms + "ms";
    }
    function ms() {
        return "= 1ms";
    }
    function mbSSD() {
        var ns = getSSDTransmissionDelay(getPayloadBytes());
        var ms = ns / 1000000;
        return "Read 1 MB sequentially from SSD: " + ns + "ns = " + ms + "ms";
    }
    function seek() {
      var ns = getSeek();
      var ms = ns / 1000000;
      return "Disk seek: "+ ns + "ns = " + ms + "ms";
    }
    function mbDisk() {
      var ns = getDiskTransmissionDelay(getPayloadBytes());
      var ms = ns / 1000000;
      return "Read 1MB sequentially from disk: "+ ns + "ns = " + ms + "ms";
    }
    function wan() {
      var ns = getWanRTT();
      var ms = ns / 1000000;
      return "Packet roundtrip CA to Netherlands: "+ ns + "ns = " + ms + "ms";
    }
    </script>

    <!-- Le styles -->
    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
    </style>
    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="http://twitter.github.com/bootstrap/assets/ico/favicon.png">
  </head>

  <body>
    <div class="container-fluid">
      <h4> Latency Numbers Every Programmer Should Know</h4>
      <div class="row-fluid">
        <div class="span3">
          <div id="ns" class="row-fluid">
          </div>
          <div id="L1" class="row-fluid">
          </div>
          <div id="branch" class="row-fluid">
          </div>
          <div id="L2" class="row-fluid">
          </div>
          <div id="mutex" class="row-fluid">
          </div>
          <div id="ns100" class="row-fluid">
          </div>
        </div><!--First Column-->
        <div class="span3">
          <div id="mem" class="row-fluid">
          </div>
          <div id="micro" class="row-fluid">
          </div>
          <div id="zippy" class="row-fluid">
          </div>
          <div id="tenMicro" class="row-fluid">
          </div>
        </div><!--Second Column-->
        <div class="span3">
          <div id="network" class="row-fluid">
          </div>
          <div id="ssdRandom" class="row-fluid">
          </div>
          <div id="mbMem" class="row-fluid">
          </div>
          <div id="rtt" class="row-fluid">
          </div>
          <div id="ms" class="row-fluid">
          </div>
        </div><!--Third Column-->
        <div class="span3">
          <div id="mbSSD" class="row-fluid">
          </div>
          <div id="seek" class="row-fluid">
          </div>
          <div id="mbDisk" class="row-fluid">
          </div>
          <div id="wan" class="row-fluid">
          </div>
        </div><!--Fourth Column-->
      </div><!-- row-fluid -->
    </div><!--/.fluid-container-->

    <!-- Fill in the columns -->
    <script>
    function writeToDiv(divName, contents) {
      document.getElementById(divName).innerHTML = contents
    }
    var divs = [["ns",ns()],["L1",L1()], ["branch",branch()], ["L2",L2()],
                ["mutex",mutex()],["ns100", ns100()],["mem",mem()],
                ["micro",micro()],["zippy",zippy()],["tenMicro",tenMicro()],
                ["network",network()],["ssdRandom",ssdRandom()],
                ["mbMem",mbMem()],["rtt",rtt()],["ms",ms()],
                ["mbSSD",mbSSD()],["seek",seek()],["mbDisk",mbDisk()],
                ["wan",wan()]];
    for (var i in divs) {
      var pair = divs[i];
      writeToDiv(pair[0], pair[1]);
    }
    </script>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://twitter.github.com/bootstrap/assets/js/jquery.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-transition.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-alert.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-modal.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-tab.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-popover.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-button.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-carousel.js"></script>
    <script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-typeahead.js"></script>
  </body>
</html>
</textarea>
    <script>
      var delay;
      // Initialize CodeMirror editor with a nice html5 canvas demo.
      var editor = CodeMirror.fromTextArea(document.getElementById('code'), {
        mode: 'text/html',
        tabMode: 'indent'
      });
      editor.on("change", function() {
        clearTimeout(delay);
        delay = setTimeout(updatePreview, 300);
      });
      function updatePreview() {
        var previewFrame = document.getElementById('preview');
        var preview = previewFrame.contentDocument || previewFrame.contentWindow.document;
        preview.open();
        preview.write(editor.getValue());
        preview.close();
      }
      setTimeout(updatePreview, 300);
    </script>
  </body>
</html>
